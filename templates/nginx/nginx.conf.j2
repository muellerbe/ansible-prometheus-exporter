server {
    listen       80;
    server_name  prometheus_exporter;

    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }

{% if prometheus_exporter_cadvisor_enable|bool and (prometheus_exporter_cadvisor_groupname in group_names or prometheus_exporter_cadvisor_groupname == 'all') %}
    location /metrics/cadvisor {
        proxy_pass   http://cadvisor:8080/metrics;
    }
{% endif %}

{% if prometheus_exporter_node_exporter_enable|bool and (prometheus_exporter_node_exporter_groupname in group_names or prometheus_exporter_node_exporter_groupname == 'all') %}
    location /metrics/node {
        proxy_pass   http://{{ prometheus_exporter_node_exporter_host }}:{{ prometheus_exporter_node_exporter_port }}/metrics;
    }
{% endif %}

{% if prometheus_exporter_mariadb_enable|bool and (prometheus_exporter_mariadb_groupname in group_names or prometheus_exporter_mariadb_groupname == 'all') %}
    location /metrics/mariadb {
        proxy_pass   http://mariadb:9104/metrics;
    }
{% endif %}

{% if prometheus_exporter_memcached_enable|bool and (prometheus_exporter_memcached_groupname in group_names or prometheus_exporter_memcached_groupname == 'all') %}
    location /metrics/memcached {
        proxy_pass   http://memcached:9150/metrics;
    }
{% endif %}
}
